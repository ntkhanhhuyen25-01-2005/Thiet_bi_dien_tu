{% extends "Client/base.html" %}

{% block title %}Gi·ªè h√†ng - Thi·∫øt b·ªã ƒëi·ªán t·ª≠{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">üõí Gi·ªè h√†ng</h1>
</div>

<!-- Th√¥ng b√°o khi ch∆∞a ƒëƒÉng nh·∫≠p -->
{% if not session.username %}
<div class="alert alert-warning">
  <i class="fa-solid fa-exclamation-triangle"></i> 
  <strong>L∆∞u √Ω:</strong> B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ c√≥ th·ªÉ thanh to√°n. 
  <a href="{{ url_for('dangnhap') }}" class="alert-link">ƒêƒÉng nh·∫≠p ngay</a>
</div>
{% endif %}

      <div class="card">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>H√¨nh ·∫£nh</th>
                <th>T√™n s·∫£n ph·∫©m</th>
                <th>Gi√°</th>
                <th>S·ªë l∆∞·ª£ng</th>
                <th>T·ªïng</th>
                <th style="width: 180px">H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody>
              {% if items %}
              {% for it in items %}
              <tr>
                <td>
                  <img src="{{ it.product.image }}" class="img-thumbnail" style="width: 100px" />
                </td>
                <td class="fw-bold">{{ it.product.name }}</td>
                <td class="text-success">{{ '{:,.0f}'.format(it.product.price).replace(',', '.') }} ‚Ç´</td>
                <td>
                  <form class="d-flex" method="POST" action="{{ url_for('cart_update') }}">
                    <input type="hidden" name="product_id" value="{{ it.product.id }}" />
                    <input type="number" name="quantity" value="{{ it.quantity }}" min="1" class="form-control form-control-sm text-center" style="width: 70px" />
                    <button class="btn btn-sm btn-outline-primary ms-2" type="submit">
                      <i class="fa-solid fa-pen"></i>
                    </button>
                  </form>
                </td>
                <td class="text-danger fw-bold">{{ '{:,.0f}'.format(it.line_total).replace(',', '.') }} ‚Ç´</td>
                <td>
                  <form method="POST" action="{{ url_for('cart_remove') }}" class="d-inline">
                    <input type="hidden" name="product_id" value="{{ it.product.id }}" />
                    <button class="btn btn-sm btn-outline-danger" type="submit"><i class="fa-solid fa-trash"></i></button>
                  </form>
                </td>
              </tr>
              {% endfor %}
              {% else %}
              <tr>
                <td colspan="6" class="text-center text-muted">Gi·ªè h√†ng tr·ªëng</td>
              </tr>
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>

      <!-- T·ªïng c·ªông -->
      <div class="card mt-3">
        <div
          class="card-body d-flex justify-content-between align-items-center"
        >
          <h5 class="mb-0">
            T·∫°m t√≠nh: <span class="text-danger">{{ '{:,.0f}'.format(subtotal).replace(',', '.') }} ‚Ç´</span>
            <small class="text-muted"> + ph√≠ ship {{ '{:,.0f}'.format(shipping).replace(',', '.') }} ‚Ç´</small>
          </h5>
          <div>
            <a href="{{ url_for('sanpham') }}" class="btn btn-outline-secondary"><i class="fa-solid fa-arrow-left"></i> Ti·∫øp t·ª•c mua h√†ng</a>
            {% if session.username %}
              <a href="{{ url_for('thanhtoan') }}" class="btn btn-success"><i class="fa-solid fa-credit-card"></i> Thanh to√°n</a>
            {% else %}
              <a href="{{ url_for('dangnhap') }}" class="btn btn-warning"><i class="fa-solid fa-lock"></i> ƒêƒÉng nh·∫≠p ƒë·ªÉ thanh to√°n</a>
            {% endif %}
          </div>
        </div>
      </div>
{% endblock %}
