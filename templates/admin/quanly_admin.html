{% extends "admin/base.html" %}

{% block title %}Qu·∫£n l√Ω Admin - Thi·∫øt b·ªã ƒëi·ªán t·ª≠{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0">üë• Qu·∫£n l√Ω t√†i kho·∫£n Admin</h1>
  <a href="{{ url_for('admin_register') }}" class="btn btn-primary">
    <i class="fa-solid fa-user-plus"></i> Th√™m Admin m·ªõi
  </a>
</div>

<div class="card mb-3">
  <div class="card-body">
    <form class="form-inline" action="{{ url_for('admin_search_admin') }}" method="GET">
      <div class="form-group mr-2 mb-2">
        <input type="text" name="q" class="form-control" placeholder="T√¨m theo t√™n, username, email..." value="{{ search_term or '' }}">
      </div>
      <div class="form-group mr-2 mb-2">
        <select name="type" class="form-control">
          <option value="all" {% if search_type == 'all' %}selected{% endif %}>T·∫•t c·∫£</option>
          <option value="name" {% if search_type == 'name' %}selected{% endif %}>T√™n</option>
          <option value="username" {% if search_type == 'username' %}selected{% endif %}>Username</option>
          <option value="email" {% if search_type == 'email' %}selected{% endif %}>Email</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary mb-2"><i class="fa-solid fa-magnifying-glass"></i> T√¨m ki·∫øm</button>
      <a href="{{ url_for('admin_quanly_admin') }}" class="btn btn-outline-secondary mb-2 ml-2"><i class="fa-solid fa-refresh"></i> Xem t·∫•t c·∫£</a>
    </form>
  </div>
</div>

<!-- Th√¥ng b√°o quy·ªÅn -->
<div class="alert alert-info">
  <i class="fa-solid fa-info-circle"></i>
  <strong>L∆∞u √Ω:</strong> Ch·ªâ Super Admin m·ªõi c√≥ th·ªÉ qu·∫£n l√Ω t√†i kho·∫£n admin kh√°c.
</div>

<div class="card">
  <div class="table-responsive">
    <table class="table table-hover mb-0">
      <thead class="thead-light">
        <tr>
          <th>ID</th>
          <th>T√™n ƒëƒÉng nh·∫≠p</th>
          <th>H·ªç t√™n</th>
          <th>Email</th>
          <th>Vai tr√≤</th>
          <th>Ng√†y t·∫°o</th>
          <th>Tr·∫°ng th√°i</th>
          <th style="width:140px">H√†nh ƒë·ªông</th>
        </tr>
      </thead>
      <tbody>
        {% if admins %}
          {% for username, admin in admins %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>
              <strong>{{ username }}</strong>
              {% if username == session.admin_username %}
                <span class="badge badge-primary ml-1">B·∫°n</span>
              {% endif %}
            </td>
            <td>{{ admin.first_name }} {{ admin.last_name }}</td>
            <td>{{ admin.email }}</td>
            <td>
              {% if admin.role == 'super_admin' %}
                <span class="badge badge-danger">Super Admin</span>
              {% else %}
                <span class="badge badge-info">Admin</span>
              {% endif %}
            </td>
            <td>{{ admin.created_at }}</td>
            <td><span class="badge badge-success">Ho·∫°t ƒë·ªông</span></td>
            <td>
              {% if username != session.admin_username %}
                <button class="btn btn-sm btn-outline-primary" title="Ch·ªânh s·ª≠a">
                  <i class="fa-solid fa-pen"></i>
                </button>
                <button class="btn btn-sm btn-outline-warning" title="Kh√≥a t√†i kho·∫£n">
                  <i class="fa-solid fa-lock"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" title="X√≥a admin">
                  <i class="fa-solid fa-trash"></i>
                </button>
              {% else %}
                <span class="text-muted">T√†i kho·∫£n hi·ªán t·∫°i</span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="8" class="text-center text-muted">
              Ch∆∞a c√≥ t√†i kho·∫£n admin n√†o
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>

<!-- Th·ªëng k√™ -->
<div class="row mt-4">
  <div class="col-md-3">
    <div class="card bg-primary text-white">
      <div class="card-body text-center">
        <h5 class="card-title">{{ admins|length }}</h5>
        <p class="card-text">T·ªïng s·ªë Admin</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-success text-white">
      <div class="card-body text-center">
        <h5 class="card-title">
          {{ admins|selectattr('1.role', 'equalto', 'super_admin')|list|length }}
        </h5>
        <p class="card-text">Super Admin</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-info text-white">
      <div class="card-body text-center">
        <h5 class="card-title">
          {{ admins|selectattr('1.role', 'equalto', 'admin')|list|length }}
        </h5>
        <p class="card-text">Admin th∆∞·ªùng</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-warning text-white">
      <div class="card-body text-center">
        <h5 class="card-title">{{ admins|length }}</h5>
        <p class="card-text">ƒêang ho·∫°t ƒë·ªông</p>
      </div>
    </div>
  </div>
</div>
{% endblock %}
